<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');.lst-kix_ko8bmbyt0tt2-8>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-7>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-6>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-1>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-2>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-4>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-3>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-5>li:before{content:"-  "}.lst-kix_ko8bmbyt0tt2-0>li:before{content:"-  "}ul.lst-kix_ko8bmbyt0tt2-6{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-5{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-8{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-7{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-2{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-1{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-4{list-style-type:none}ul.lst-kix_ko8bmbyt0tt2-3{list-style-type:none}.lst-kix_kytdt9nljkzl-1>li:before{content:"-  "}.lst-kix_kytdt9nljkzl-0>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-6>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-7>li:before{content:"-  "}.lst-kix_kytdt9nljkzl-5>li:before{content:"-  "}.lst-kix_kytdt9nljkzl-3>li:before{content:"-  "}.lst-kix_kytdt9nljkzl-2>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-8>li:before{content:"-  "}.lst-kix_kytdt9nljkzl-6>li:before{content:"-  "}ul.lst-kix_4cuyuia36jiu-0{list-style-type:none}ul.lst-kix_4cuyuia36jiu-1{list-style-type:none}ul.lst-kix_4cuyuia36jiu-2{list-style-type:none}ul.lst-kix_4cuyuia36jiu-3{list-style-type:none}ul.lst-kix_4cuyuia36jiu-4{list-style-type:none}ul.lst-kix_4cuyuia36jiu-5{list-style-type:none}ul.lst-kix_4cuyuia36jiu-6{list-style-type:none}.lst-kix_kytdt9nljkzl-4>li:before{content:"-  "}ul.lst-kix_4cuyuia36jiu-7{list-style-type:none}ul.lst-kix_4cuyuia36jiu-8{list-style-type:none}ul.lst-kix_kytdt9nljkzl-8{list-style-type:none}ul.lst-kix_kytdt9nljkzl-7{list-style-type:none}ul.lst-kix_kytdt9nljkzl-6{list-style-type:none}ul.lst-kix_kytdt9nljkzl-5{list-style-type:none}.lst-kix_4cuyuia36jiu-0>li:before{content:"-  "}ul.lst-kix_kytdt9nljkzl-0{list-style-type:none}.lst-kix_kytdt9nljkzl-7>li:before{content:"-  "}ul.lst-kix_kytdt9nljkzl-4{list-style-type:none}ul.lst-kix_kytdt9nljkzl-3{list-style-type:none}ul.lst-kix_kytdt9nljkzl-2{list-style-type:none}ul.lst-kix_kytdt9nljkzl-1{list-style-type:none}.lst-kix_kytdt9nljkzl-8>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-5>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-4>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-2>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-1>li:before{content:"-  "}.lst-kix_4cuyuia36jiu-3>li:before{content:"-  "}ul.lst-kix_ko8bmbyt0tt2-0{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c33{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#d9d9d9;border-left-style:solid;border-bottom-width:1pt;width:479.2pt;border-top-color:#000000;border-bottom-style:solid}.c18{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:210.8pt;border-top-color:#000000;border-bottom-style:solid}.c19{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:319.5pt;border-top-color:#000000;border-bottom-style:solid}.c2{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:28.5pt;border-top-color:#000000;border-bottom-style:solid}.c22{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:130.5pt;border-top-color:#000000;border-bottom-style:solid}.c13{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:middle;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:211.5pt;border-top-color:#000000;border-bottom-style:solid}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Consolas";font-style:normal}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify;height:11pt}.c14{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c36{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c20{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center;height:11pt}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c21{color:#000000;font-weight:400;text-decoration:none;font-size:11pt;font-family:"Arial";font-style:normal}.c28{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial"}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c17{padding-top:0pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;text-align:justify}.c29{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;text-align:center}.c12{border-spacing:0;border-collapse:collapse;margin-right:auto}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:justify}.c32{color:#000000;text-decoration:none;font-size:11pt;font-style:normal}.c27{margin-left:-12pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c35{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c31{padding:0;margin:0}.c7{margin-left:36pt;padding-left:0pt}.c9{font-weight:400;font-family:"Consolas"}.c26{height:18pt}.c16{margin-left:36pt}.c24{vertical-align:super}.c15{height:0pt}.c30{height:156pt}.c10{font-style:italic}.c34{height:168pt}.c23{height:11pt}.c11{vertical-align:sub}.c25{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c35"><p class="c29 title" id="h.jxh2gywk7p1"><span class="c36">String Matching usando Transformada Discreta de Fourier</span></p><p class="c4"><span class="c3"></span></p><p class="c17 c23 subtitle" id="h.8ic2se94nu2j"><span class="c14"></span></p><p class="c17 subtitle" id="h.vipu9vdqoaa7"><span class="c14">Notaci&oacute;n</span></p><p class="c5"><span class="c3">Considerando el problema de matching exacto de cadenas de caracteres, sean:</span></p><ul class="c31 lst-kix_4cuyuia36jiu-0 start"><li class="c5 c7"><span class="c9 c10">t</span><span class="c3">: Un texto</span></li><li class="c5 c7"><span class="c9 c10">p</span><span class="c3">: Un patr&oacute;n a buscar dentro del texto</span></li><li class="c5 c7"><span class="c9 c10">t[n]</span><span class="c3">: Una representaci&oacute;n num&eacute;rica del n-&eacute;simo caracter de t</span></li><li class="c5 c7"><span class="c9 c10">p[n]</span><span class="c3">: Una representaci&oacute;n num&eacute;rica del n-&eacute;simo caracter de p</span></li><li class="c5 c7"><span class="c9 c10">N</span><span class="c3">: La longitud del texto t</span></li><li class="c5 c7"><span class="c9 c10">M</span><span class="c3">: La longitud del patr&oacute;n p</span></li><li class="c5 c7"><span class="c9 c10">((x))</span><span class="c9 c10 c11">a</span><span class="c3">: La operaci&oacute;n x mod a</span></li></ul><p class="c4"><span class="c3"></span></p><p class="c17 c23 subtitle" id="h.76fe2tg8nkm7"><span class="c14"></span></p><p class="c17 subtitle" id="h.7a3ujo884qn5"><span class="c14">Planteo Formal</span></p><p class="c5"><span class="c3">El problema se puede escribir como:</span></p><p class="c5"><img src="images/image1.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">O bien, por conveniencia, calculamos la convergencia cuadr&aacute;tica (notar que no estamos elevando ambos miembros al cuadrado, sino cada t&eacute;rmino):</span></p><p class="c5"><img src="images/image2.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Desarrollando cada binomio de la sumatoria:</span></p><p class="c5"><img src="images/image3.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span>Multiplicando punto a punto por el arreglo </span><span class="c9 c10">t[i+k]</span><span class="c3">:</span></p><p class="c5"><img src="images/image4.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span>Y haciendo lo propio por el arreglo </span><span class="c9 c10">p[k]</span><span class="c3">:</span></p><p class="c5"><img src="images/image5.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span>Extendiendo con ceros el arreglo </span><span class="c9 c10">p</span><span class="c3">, puedo cambiar los l&iacute;mites de la sumatoria:</span></p><p class="c5"><img src="images/image6.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Por asociatividad de la suma:</span></p><p class="c5"><img src="images/image7.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Aplicando la definici&oacute;n de convoluci&oacute;n circular:</span></p><p class="c5"><img src="images/image8.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Sean:</span></p><ul class="c31 lst-kix_ko8bmbyt0tt2-0 start"><li class="c5 c7"><span class="c9 c10">T</span><span class="c9 c10 c11">i</span><span class="c9 c10">[k]</span><span>: La DFT de </span><span class="c9 c10">t[n]</span><span class="c9 c24 c10">i</span><span class="c3">.</span></li><li class="c5 c7"><span class="c9 c10">P</span><span class="c9 c10 c11">i</span><span class="c9 c10">[k]</span><span>: La DFT de </span><span class="c9 c10">p[n]</span><span class="c9 c24 c10">i</span><span class="c3">.</span></li></ul><p class="c5"><span class="c3">Y las siguientes propiedades de la transformada discreta de Fourier:</span></p><ul class="c31 lst-kix_ko8bmbyt0tt2-0"><li class="c5 c7"><span class="c10">DFT</span><span class="c10 c11">N</span><span class="c10">{ x[((n-a))</span><span class="c10 c11">N</span><span class="c10">] } = e</span><span class="c24 c10">-j (2&pi;/N) a k</span><span class="c10 c28">&nbsp;X[k]</span></li><li class="c5 c7"><span class="c10">DFT</span><span class="c10 c11">N</span><span class="c10">{ x</span><span class="c24 c10">*</span><span class="c10">[((-n))</span><span class="c10 c11">N</span><span class="c10">] } = X</span><span class="c24 c10">*</span><span class="c28 c10">[k]</span></li></ul><p class="c4"><span class="c28 c10"></span></p><p class="c5"><span class="c3">Puedo transformar ambos miembros de la ecuaci&oacute;n como:</span></p><p class="c5"><img></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Aplicando los productos puntuales en cada t&eacute;rmino:</span></p><p class="c5"><img src="images/image9.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Y aplicando la transformada inversa:</span></p><p class="c5"><img src="images/image10.png"></p><p class="c4"><span class="c3"></span></p><p class="c5"><span>Finalmente, si se cumple esta ecuaci&oacute;n, hay un match que comienza en la posici&oacute;n </span><span class="c9 c10">i</span><span>&nbsp;de </span><span class="c9 c10">t</span><span class="c3">.</span></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Adem&aacute;s, se observan las siguientes igualdades:</span></p><p class="c5 c16"><img src="images/image11.png"></p><p class="c5 c16"><img src="images/image12.png"></p><p class="c5 c16"><img src="images/image13.png"></p><p class="c4"><span class="c3"></span></p><p class="c17 c23 subtitle" id="h.dca1hvfv7cdi"><span class="c14"></span></p><p class="c17 c23 subtitle" id="h.q6bovku63oda"><span class="c14"></span></p><hr style="page-break-before:always;display:none;"><p class="c17 c23 subtitle" id="h.3iswcp5ypqgz"><span class="c14"></span></p><p class="c17 subtitle" id="h.2em5wwi3hcza"><span class="c14">Algoritmo</span></p><p class="c5"><span class="c3">A partir del planteo anterior y utilizando como primitiva una implementaci&oacute;n de la transformada r&aacute;pida de Fourier (con orden algor&iacute;tmico O(N*log(N))), podemos escribir el siguiente algoritmo:</span></p><p class="c4"><span class="c3"></span></p><a id="t.37ee6d03d26e6b4cb7f82358e97e5c76ab1f3ef8"></a><a id="t.0"></a><table class="c27"><tbody><tr class="c15"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c6"># Sea la Transformada R&aacute;pida de Fourier (Fast Fourier Transform):</span></p><p class="c1"><span class="c6">Arreglo&lt;N&gt; FFT(Arreglo&lt;N&gt;)</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># Se instancian los arreglos</span></p><p class="c1"><span class="c9">t</span><span class="c9 c11">1</span><span class="c9">, t</span><span class="c9 c11">2</span><span class="c9">, t</span><span class="c9 c11">3</span><span class="c9">, p</span><span class="c9 c11">1</span><span class="c9">, p</span><span class="c9 c11">2</span><span class="c9">, p</span><span class="c9 c11">3</span><span class="c6">&nbsp;= Arreglos de largo N inicializado con ceros</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># Representaci&oacute;n num&eacute;rica del texto</span></p><p class="c1"><span class="c6">for i in 0..N-1:</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; t</span><span class="c9 c11">1</span><span class="c6">[i] := Representaci&oacute;n num&eacute;rica del i-&eacute;simo caracter del texto</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; t</span><span class="c9 c11">2</span><span class="c9">[i] := t</span><span class="c9 c11">1</span><span class="c9">[i] * t</span><span class="c9 c11">1</span><span class="c6">[i]</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; t</span><span class="c9 c11">3</span><span class="c9">[i] := t</span><span class="c9 c11">2</span><span class="c9">[i] * t</span><span class="c9 c11">1</span><span class="c6">[i]</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># Representaci&oacute;n num&eacute;rica del patr&oacute;n invirtiendo el dominio</span></p><p class="c1"><span class="c6">for i in 0..M-1:</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; p</span><span class="c9 c11">1</span><span class="c6">[M-i-1] := Representaci&oacute;n i-&eacute;simo caracter del pattern</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; p</span><span class="c9 c11">2</span><span class="c9">[M-i-1] := p</span><span class="c9 c11">1</span><span class="c9">[M-i-1] * p</span><span class="c9 c11">1</span><span class="c6">[M-i-1]</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; p</span><span class="c9 c11">3</span><span class="c9">[M-i-1] := p</span><span class="c9 c11">2</span><span class="c9">[M-i-1] * p</span><span class="c9 c11">1</span><span class="c6">[M-i-1]</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># C&aacute;lculo de las transformadas discretas de Fourier del texto</span></p><p class="c1"><span class="c9">T</span><span class="c9 c11">1</span><span class="c9">&nbsp;:= FFT(t</span><span class="c9 c11">1</span><span class="c6">)</span></p><p class="c1"><span class="c9">T</span><span class="c9 c11">2</span><span class="c9">&nbsp;:= FFT(t</span><span class="c9 c11">2</span><span class="c6">)</span></p><p class="c1"><span class="c9">T</span><span class="c9 c11">3</span><span class="c9">&nbsp;:= FFT(t</span><span class="c9 c11">3</span><span class="c6">)</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># C&aacute;lculo de las transformadas discretas de Fourier del patr&oacute;n</span></p><p class="c1"><span class="c9">P</span><span class="c9 c11">1</span><span class="c9">&nbsp;:= FFT(p</span><span class="c9 c11">1</span><span class="c6">)</span></p><p class="c1"><span class="c9">P</span><span class="c9 c11">2</span><span class="c9">&nbsp;:= FFT(p</span><span class="c9 c11">2</span><span class="c6">)</span></p><p class="c1"><span class="c9">P</span><span class="c9 c11">3</span><span class="c9">&nbsp;:= FFT(p</span><span class="c9 c11">3</span><span class="c6">)</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># Productos punto a punto de las transformadas</span></p><p class="c1"><span class="c9">R</span><span class="c9 c11">1</span><span class="c9">&nbsp;:= T</span><span class="c9 c11">3</span><span class="c9">&nbsp;* P</span><span class="c9 c11 c32">1</span></p><p class="c1"><span class="c9">R</span><span class="c9 c11">2</span><span class="c9">&nbsp;:= T</span><span class="c9 c11">2</span><span class="c9">&nbsp;* P</span><span class="c32 c9 c11">2</span></p><p class="c1"><span class="c9">R</span><span class="c9 c11">3</span><span class="c9">&nbsp;:= T</span><span class="c9 c11">1</span><span class="c9">&nbsp;* P</span><span class="c32 c9 c11">3</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6"># C&aacute;lculo de las transformadas inversas de los productos</span></p><p class="c1"><span class="c9">r</span><span class="c9 c11">1</span><span class="c9">&nbsp;:= IFFT(R</span><span class="c9 c11">1</span><span class="c6">)</span></p><p class="c1"><span class="c9">r</span><span class="c9 c11">2</span><span class="c9">&nbsp;:= IFFT(R</span><span class="c9 c11">2</span><span class="c6">)</span></p><p class="c1"><span class="c9">r</span><span class="c9 c11">3</span><span class="c9">&nbsp;:= IFFT(R</span><span class="c9 c11">3</span><span class="c6">)</span></p><p class="c1 c23"><span class="c6"></span></p><p class="c1"><span class="c6">for i in 0..N-M:</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; if r</span><span class="c9 c11">1</span><span class="c9">[M-1-i] - 2 * r</span><span class="c9 c11">2</span><span class="c9">[M-1-i] + r</span><span class="c9 c11">3</span><span class="c6">[M-1-i] == 0:</span></p><p class="c1"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp; Mostrar match en la posici&oacute;n i</span></p></td></tr></tbody></table><p class="c4"><span class="c3"></span></p><p class="c17 subtitle" id="h.eap6hyt2lbyu"><span class="c14">Orden del Algoritmo</span></p><p class="c8"><span>Como la </span><span class="c10 c25">FFT</span><span>&nbsp;tiene orden </span><span class="c10 c25">O(N*log(N))</span><span>, y el resto de las operaciones del algoritmo son de orden lineal, se conservar&aacute; el orden de la </span><span class="c10 c25">FFT</span><span class="c3">.</span></p><p class="c17 c23 subtitle" id="h.41ii986pkykx"><span class="c14"></span></p><p class="c17 subtitle" id="h.mbwvstwavrsm"><span class="c14">Ejemplo gr&aacute;fico</span></p><p class="c8"><span>Buscaremos la subcadena </span><span class="c9">&lsquo;ANA&rsquo;</span><span>&nbsp;dentro de la cadena </span><span class="c9">&lsquo;BANANA&rsquo;</span><span class="c3">.</span></p><p class="c8"><span class="c3">Tenemos entonces:</span></p><ul class="c31 lst-kix_4cuyuia36jiu-0"><li class="c5 c7"><span class="c9 c10">t</span><span class="c6">&nbsp;= {1, 2, 3, 2, 3, 2}</span></li><li class="c5 c7"><span class="c9 c10">p</span><span class="c6">&nbsp;= {2, 3, 2, 0, 0, 0}</span></li><li class="c5 c7"><span class="c6">El patr&oacute;n invertido ser&aacute; tambi&eacute;n p&rsquo; = {2, 3, 2, 0, 0, 0}</span></li><li class="c5 c7"><span class="c9 c10">N</span><span class="c6">&nbsp;= 6</span></li><li class="c5 c7"><span class="c9 c10">M</span><span class="c9">&nbsp;= 3</span></li></ul><p class="c5"><span class="c3">El texto representado como se&ntilde;al se ver&aacute; como:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 363.50px; height: 270.44px;"><img alt="text.png" src="images/image29.png" style="width: 363.50px; height: 270.44px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c3">Y el patr&oacute;n (ya invertido) como:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 365.50px; height: 273.21px;"><img alt="patt1-0.png" src="images/image17.png" style="width: 365.50px; height: 273.21px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c3"></span></p><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Las se&ntilde;ales elevadas punto a punto al cuadrado y al cubo:</span></p><p class="c4"><span class="c3"></span></p><a id="t.035bb471503ae0d5d71dc8fffbfc7a6125757644"></a><a id="t.1"></a><table class="c12"><tbody><tr class="c26"><td class="c2" colspan="1" rowspan="1"><p class="c0 c23"><span class="c3"></span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span class="c3">Texto</span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span class="c3">Patr&oacute;n</span></p></td></tr><tr class="c34"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span class="c3">x</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 274.51px; height: 208.50px;"><img alt="text.png" src="images/image29.png" style="width: 274.51px; height: 208.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.91px; height: 208.50px;"><img alt="patt1-0.png" src="images/image17.png" style="width: 273.91px; height: 208.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c30"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span>x</span><span class="c21 c24">2</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.50px; height: 205.86px;"><img alt="t2.png" src="images/image30.png" style="width: 273.50px; height: 205.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.02px; height: 205.50px;"><img alt="p2.png" src="images/image16.png" style="width: 273.02px; height: 205.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span>x</span><span class="c21 c24">3</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 272.34px; height: 205.50px;"><img alt="t3.png" src="images/image19.png" style="width: 272.34px; height: 205.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.02px; height: 205.50px;"><img alt="p3.png" src="images/image15.png" style="width: 273.02px; height: 205.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c20"><span class="c3"></span></p><hr style="page-break-before:always;display:none;"><p class="c20"><span class="c3"></span></p><p class="c5"><span class="c3">Sus transformadas de Fourier discretas (tomo parte real para graficar en dos dimesiones):</span></p><p class="c4"><span class="c3"></span></p><a id="t.4e503c1ff10ef856882a35804f51272df372dda3"></a><a id="t.2"></a><table class="c12"><tbody><tr class="c26"><td class="c2" colspan="1" rowspan="1"><p class="c0 c23"><span class="c3"></span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span class="c3">Texto</span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span class="c3">Patr&oacute;n</span></p></td></tr><tr class="c34"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span>X</span><span class="c21 c11">1</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 274.51px; height: 208.50px;"><img alt="fftt1.png" src="images/image20.png" style="width: 278.00px; height: 208.50px; margin-left: -1.75px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.91px; height: 208.50px;"><img alt="fftp1.png" src="images/image25.png" style="width: 278.00px; height: 208.50px; margin-left: -2.04px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c30"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span>X</span><span class="c21 c11">2</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.50px; height: 205.86px;"><img alt="fftt2.png" src="images/image24.png" style="width: 274.48px; height: 205.86px; margin-left: -0.49px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.02px; height: 205.50px;"><img alt="fftp2.png" src="images/image21.png" style="width: 274.00px; height: 205.50px; margin-left: -0.49px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c2" colspan="1" rowspan="1"><p class="c0"><span>X</span><span class="c21 c11">3</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 272.34px; height: 205.50px;"><img alt="fftt3.png" src="images/image14.png" style="width: 274.00px; height: 205.50px; margin-left: -0.83px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td><td class="c18" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 273.02px; height: 205.50px;"><img alt="fftp3.png" src="images/image18.png" style="width: 274.00px; height: 205.50px; margin-left: -0.49px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c20"><span class="c3"></span></p><p class="c20"><span class="c3"></span></p><hr style="page-break-before:always;display:none;"><p class="c20"><span class="c3"></span></p><p class="c5"><span class="c3">Haciendo el producto punto a punto de las se&ntilde;ales:</span></p><p class="c4"><span class="c3"></span></p><a id="t.06d22044296f0271ff446b0c71aefd473f4240c6"></a><a id="t.3"></a><table class="c12"><tbody><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>R</span><span class="c11">1</span><span>&nbsp;= </span><span>T</span><span class="c11">3</span><span>P</span><span class="c21 c11">1</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 354.50px; height: 267.31px;"><img alt="t3p1.png" src="images/image27.png" style="width: 354.50px; height: 267.31px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>R</span><span class="c11">2</span><span>&nbsp;= </span><span>T</span><span class="c11">2</span><span>P</span><span class="c21 c11">2</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.67px; height: 267.50px;"><img alt="t2p2.png" src="images/image31.png" style="width: 356.67px; height: 267.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>R</span><span class="c11">3</span><span>&nbsp;= </span><span>T</span><span class="c11">1</span><span>P</span><span class="c21 c11">3</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 352.50px; height: 264.99px;"><img alt="t1p3.png" src="images/image22.png" style="width: 352.50px; height: 264.99px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c4"><span class="c3"></span></p><p class="c5"><span class="c3">Aplicando la transformada discreta inversa de Fourier:</span></p><p class="c4"><span class="c3"></span></p><a id="t.560c46e9ddd4e63d14822c79a67182a32055ee12"></a><a id="t.4"></a><table class="c12"><tbody><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>r</span><span class="c11">1</span><span>&nbsp;= IDFT(</span><span>R</span><span class="c11">1</span><span class="c3">)</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 354.50px; height: 267.31px;"><img alt="r1.png" src="images/image32.png" style="width: 356.42px; height: 267.31px; margin-left: -0.96px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>r</span><span class="c11">2</span><span>&nbsp;= IDFT(R</span><span class="c11">2</span><span>)</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.67px; height: 267.50px;"><img alt="r2.png" src="images/image23.png" style="width: 356.67px; height: 267.50px; margin-left: 0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr><tr class="c15"><td class="c22" colspan="1" rowspan="1"><p class="c0"><span>r</span><span class="c11">3</span><span>&nbsp;= IDFT(R</span><span class="c11">3</span><span>)</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 352.50px; height: 264.99px;"><img alt="r3.png" src="images/image28.png" style="width: 353.32px; height: 264.99px; margin-left: -0.41px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c4"><span class="c3"></span></p><p class="c5"><span>Y por &uacute;ltimo, aplicando la combinaci&oacute;n lineal </span><span class="c9 c10">r</span><span class="c9 c10 c11">1</span><span class="c9 c10">[i] - 2 r</span><span class="c9 c10 c11">2</span><span class="c9 c10">[i] + r</span><span class="c9 c10 c11">3</span><span class="c9 c10">[i]</span><span class="c3">&nbsp;punto a punto:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 450.67px;"><img alt="result.png" src="images/image26.png" style="width: 601.70px; height: 450.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>Vemos que hay ceros en </span><span class="c9 c10">i=3</span><span>&nbsp;e </span><span class="c9 c10">i=5</span><span>, lo cual quiere decir que los matches terminan en las posiciones </span><span class="c9 c10">3</span><span>&nbsp;y </span><span class="c9 c10">5</span><span>&nbsp;del texto (empiezan en </span><span class="c9 c10">n=3+M-1=1</span><span>&nbsp;y </span><span class="c9 c10">n=5+M-1=3</span><span class="c3">).</span></p><p class="c4"><span class="c3"></span></p><p class="c4"><span class="c3"></span></p><p class="c17 subtitle" id="h.3wlqsidtyo18"><span class="c14">Adaptaciones del Algoritmo</span></p><ul class="c31 lst-kix_kytdt9nljkzl-0 start"><li class="c5 c7"><span>Si buscamos sub-cadenas, s&oacute;lo tenemos en cuenta las posiciones entre </span><span class="c9 c10">M-1</span><span>&nbsp;y </span><span class="c9 c10">N-1</span><span class="c3">&nbsp;de la se&ntilde;al resultante, las anteriores son &uacute;tiles para buscar sub-cadenas en el texto visto de manera circular (encontrar un match desde la posici&oacute;n -2 hasta la 3, por ejemplo).</span></li><li class="c5 c7"><span>Si queremos buscar con &ldquo;</span><span class="c10">don&rsquo;t cares</span><span>&rdquo; (cualquier caracter), simplemente tenemos que poner un cero en la representaci&oacute;n del caracter correspondiente en la representaci&oacute;n num&eacute;rica del patr&oacute;n.</span></li></ul></body></html>